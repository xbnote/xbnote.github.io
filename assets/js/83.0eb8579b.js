(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{621:function(s,a,t){"use strict";t.r(a);var r=t(1),e=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引"}},[s._v("#")]),s._v(" 索引")]),s._v(" "),a("p",[s._v("索引：是帮助 MySQL 高效获取数据的 "),a("strong",[s._v("排好序的数据结构")])]),s._v(" "),a("h3",{attrs:{id:"为什么使用-b-树"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用-b-树"}},[s._v("#")]),s._v(" 为什么使用 B+ 树")]),s._v(" "),a("p",[s._v("二叉树：当存储递增序列时会出现树右倾斜的情况，查询效率退化成链表")]),s._v(" "),a("p",[s._v("红黑树：二叉平衡树，其高度不可控，会造成大量的 IO 操作")]),s._v(" "),a("p",[s._v("B+树（B树变种）：")]),s._v(" "),a("ol",[a("li",[s._v("非叶子节点不存储 data，只存储索引，可以存放更多的索引")]),s._v(" "),a("li",[s._v("叶子节点包含了索引字段")]),s._v(" "),a("li",[s._v("叶子节点通过指针连接，提高区间访问效率")])]),s._v(" "),a("p",[s._v("B+数每个节点大小为 16KB，以 BigInt 数据类型为例，一个节点可以存储 1170 个索引，也就是说，三层的 B+ 树可以存储 20 万+ 的数据。")]),s._v(" "),a("h3",{attrs:{id:"myisam-存储引擎"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#myisam-存储引擎"}},[s._v("#")]),s._v(" MyISAM 存储引擎")]),s._v(" "),a("ol",[a("li",[s._v("MySQL 使用 .MYI 文件存储索引，使用 .MYD 文件存储数据；")]),s._v(" "),a("li",[s._v("MyISAM 存储引擎索引与数据分离，非叶子节点存放索引，叶子节点存放数据地址。")])]),s._v(" "),a("h3",{attrs:{id:"innodb-存储引擎"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#innodb-存储引擎"}},[s._v("#")]),s._v(" InnoDB 存储引擎")]),s._v(" "),a("ol",[a("li",[s._v("表数据文件本身是按 B+ 数组织的一个索引结构文件；")]),s._v(" "),a("li",[s._v("主键构成的索引称为做 "),a("strong",[s._v("聚集索引")]),s._v("，其叶子节点包含了完整的数据记录；")]),s._v(" "),a("li",[s._v("非主键构成的索引称为 "),a("strong",[s._v("辅助索引")]),s._v("，其叶子节点包含了主键。")]),s._v(" "),a("li",[s._v("数据表必须建立主键。若不建立主键 InnoDB 会自动选择一列唯一索引作为主键，若表中没有建立唯一索引；InnoDB 会自动创建一个隐藏的 rowId字段 作为主键。")]),s._v(" "),a("li",[s._v("推荐使用整形自增主键，整形查询效率比字符串要高，此外自增主键使添加数据操作在节点尾部进行，减小了索引维护代价；")]),s._v(" "),a("li",[s._v("非主键索引结构子节点存储的是主键值，可以有效节省空间，同时保证索引结构的一致性。")])]),s._v(" "),a("h3",{attrs:{id:"hash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hash"}},[s._v("#")]),s._v(" Hash")]),s._v(" "),a("ol",[a("li",[s._v("对索引的 Key 进行一次 hash 运算定位到数据存储的位置；")]),s._v(" "),a("li",[s._v("很多时候 Hash 索引要比 B+ 数更加高效；")]),s._v(" "),a("li",[s._v("仅能满足 “=”、 “IN”，不支持范围索引；")]),s._v(" "),a("li",[s._v("不可避免出现 hash 冲突问题")])]),s._v(" "),a("h3",{attrs:{id:"索引选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引选择"}},[s._v("#")]),s._v(" 索引选择")]),s._v(" "),a("p",[s._v("叶子节点使用双向指针是为了实现范围查询")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://images.xbnote.top/images/20220418134651.png",alt:"image-20220418134642976"}})]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先走索引查询 a = 5，然后返回 a = 5 之后的数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先走索引查询 a = 5，然后返回 a = 5 之前的数据")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"回表查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回表查询"}},[s._v("#")]),s._v(" 回表查询")]),s._v(" "),a("p",[s._v("使用辅助索引进行查询时，需要先查询到对应数据的主键，查询出的主键集合称为回表。")])])}),[],!1,null,null,null);a.default=e.exports}}]);